<!DOCTYPE html>
<html>
<title>CALCULADORA SAC</title>
<meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<style>
    html {
        zoom: 80%;
    }
</style>

<body>

    <div class="w3-sidebar w3-bar-block w3-light-grey w3-card" style="width:300px">
        <img src="https://upload.wikimedia.org/wikipedia/commons/7/76/Verisure_logo.svg" width="200"
            style="margin-left:10px;margin-top:10px">
        <h2 class="w3-bar-item">CALCULADORA SAC</h2>
        <button class="w3-bar-item w3-button w3-ripple tablink" onclick="openCalc(event, 'PRI')">PRÓ-RATA DE
            INÍCIO</button>
        <button class="w3-bar-item w3-button w3-ripple tablink" onclick="openCalc(event, 'PRC')">PRÓ-RATA DE
            CANCELAMENTO</button>
        <button class="w3-bar-item w3-button w3-ripple tablink" onclick="openCalc(event, 'NM')">NEGOCIAR
            MONITORIA</button>
    </div>

    <div style="margin-left:300px">
        <div id="PRI" class="w3-container calc" style="display: none">
            <h2 class="w3-red">PRÓ-RATA DE INÍCIO</h2>

            <h6>
                <table cellpadding="3" cellspacing="3" align="left">
                    <tr>
                        <td class="col1">Valor da mensalidade</td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" value="0"
                                id="mensPRI" oninput="formatarValorCampo(this)"></td>
                    </tr>
                    <tr>
                        <td class="col1">Data de início do contrato</td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" type="date"
                                id="dtiniPRI"></td>
                    </tr>
                    <tr>
                        <td class="col1">Data de vencimento do título</td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" type="date"
                                id="dtvencPRI"></td>
                    </tr>
                    <tr>
                        <td class="col1">Tem retenção de ISS?<br><i>(insira a porcentagem)</i></td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" value="0"
                                id="ISSPRI"></td>
                    </tr>
                    <tr>
                        <td class="col1">Tem retenção de IR?</td>
                        <td class="col2">
                            <select class="w3-select w3-border-red" style="width:100px" id="IRPRI">
                                <option value="0">NÃO</option>
                                <option value="1">SIM</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class="col1">Tem retenção de PCC?</td>
                        <td class="col2">
                            <select class="w3-select w3-border-red" style="width:100px" id="PCCPRI">
                                <option value="0">NÃO</option>
                                <option value="1">SIM</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class="col1">Contrato parcelado?</td>
                        <td class="col2">
                            <select class="w3-select w3-border-red" style="width:100px" id="FinPRI">
                                <option value="0">NÃO</option>
                                <option value="1">SIM</option>
                            </select>
                        </td>
                    </tr>
                    <tr colspan="1" align="center">
                        <td class="col1">
                            <button class="w3-button w3-red w3-ripple" onclick="calcularPRI()"
                                style="width:150px">Calcular</button>
                        </td>
                        <td class="col2">
                        </td>
                    </tr>
                    <tr>
                        <td class="col1">Quantidade de dias utilizados</td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" id="qtdiasPRI"
                                readonly></td>
                    </tr>
                    <tr>
                        <td class="col1">Valor do ISS</td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" id="VlISSPRI"
                                readonly></td>
                    </tr>
                    <tr>
                        <td class="col1">Valor do IR</td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" id="VlIRPRI"
                                readonly></td>
                    </tr>
                    <tr>
                        <td class="col1">Valor do PCC</td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" id="VlPCCPRI"
                                readonly></td>
                    </tr>
                    <tr>
                        <td class="col1">Valor do parcelamento</td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" id="VlFinPRI"
                                readonly></td>
                    </tr>
                    <tr>
                        <td class="col1">Valor a pagar</td>
                        <td class="col2"><input class="w3-input w3-border-red" style="width:200px" id="VlPagPRI"
                                readonly></td>
                    </tr>
                </table>
            </h6>
        </div>

        <div id="PRC" class="w3-container calc" style="display: none">
            <h2 class="w3-red">PRÓ-RATA DE CANCELAMENTO</h2>

            <h6>
                <table cellpadding="3" cellspacing="3" align="left">
                    <tr>
                        <td class="col1 w3-cell-top">
                            <table cellpadding="3" cellspacing="3" align="left">
                                <tr>
                                    <td class="col1">Valor da mensalidade</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px" value="0"
                                            id="mensPRC" oninput="formatarValorCampo(this)"></td>
                                </tr>
                                <tr>
                                    <td class="col1">Data de solicitação de cancelamento</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            type="date" id="dtcancPRC"></td>
                                </tr>
                                <tr>
                                    <td class="col1">Data de vencimento do título</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            type="date" id="dtvencPRC"></td>
                                </tr>
                                <tr>
                                    <td class="col1">Tem retenção de ISS?<br><i>(insira a porcentagem)</i></td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px" value="0"
                                            id="ISSPRC"></td>
                                </tr>
                                <tr>
                                    <td class="col1">Tem retenção de IR?</td>
                                    <td class="col2">
                                        <select class="w3-select w3-border-red" style="width:100px" id="IRPRC">
                                            <option value="0">NÃO</option>
                                            <option value="1">SIM</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col1">Tem retenção de PCC?</td>
                                    <td class="col2">
                                        <select class="w3-select w3-border-red" style="width:100px" id="PCCPRC">
                                            <option value="0">NÃO</option>
                                            <option value="1">SIM</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr colspan="1" align="center">
                                    <td class="col1">
                                        <button class="w3-button w3-red w3-ripple" onclick="calcularPRC()"
                                            style="width:150px">Calcular</button>
                                    </td>
                                    <td class="col2">
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col1">Quantidade de dias utilizados</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="qtdiasPRC" readonly></td>
                                </tr>
                                <tr>
                                    <td class="col1">Data final do aviso prévio de 30 dias</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="dtfinPRC" readonly></td>
                                </tr>
                                <tr>
                                    <td class="col1">Valor do ISS</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="VlISSPRC" readonly></td>
                                </tr>
                                <tr>
                                    <td class="col1">Valor do IR</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="VlIRPRC" readonly></td>
                                </tr>
                                <tr>
                                    <td class="col1">Valor do PCC</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="VlPCCPRC" readonly></td>
                                </tr>
                                <tr>
                                    <td class="col1">Valor a pagar</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="VlPagPRC" readonly></td>
                                </tr>
                            </table>
                        </td>
                        <td class="col2" style="width:50px"></td>
                        <td class="col3 w3-cell-top">
                            <table class="w3-card w3-light-grey" cellpadding="3" cellspacing="3">
                                <tr align="center" class="w3-light-grey">
                                    <td>
                                        ABRIR O.S. PARA:<br><b><i>SAC > BACKOFFICE > SOLICITAÇÃO ENVIO DI (DEPÓSITO
                                                IDENTIFICADO)</b></i>
                                    </td>
                                </tr>
                                <tr class="w3-dark-grey" align="center" id="txtPRC">
                                    <td>Por favor, enviar dados para DI no valor de R$ xxx,xx referente ao pró-rata de
                                        cancelamento, que foi do dia xx/xx/xxxx até yy/yy/yyyy no e-mail:</td>
                                </tr>
                                <tr align="center">
                                    <td>
                                        <button class="w3-button w3-red w3-ripple" onclick="copyTextPRC()">Clique aqui
                                            para copiar o texto</button>
                                    </td>
                                </tr>
                            </table>
                        </td>
                </table>
            </h6>
        </div>

        <div id="NM" class="w3-container calc" style="display: none">
            <h2 class="w3-red">NEGOCIAR MONITORIA</h2>

            <h6>
                <table cellpadding="3" cellspacing="3" align="left">
                    <tr>
                        <td class="col1 w3-cell-top">
                            <table cellpadding="3" cellspacing="3" align="left">
                                <tr>
                                    <td class="col1">Valor da mensalidade</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px" value="0"
                                            id="mensNM" oninput="formatarValorCampo(this)"></td>
                                </tr>
                                <tr>
                                    <td class="col1">Quantidade de estrelas</td>
                                    <td class="col2">
                                        <select class="w3-select w3-border-red" style="width:100px" id="starNM">
                                            <option value="1">★</option>
                                            <option value="2">★★</option>
                                            <option value="3">★★★</option>
                                            <option value="4">★★★★</option>
                                            <option value="5">★★★★★</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col1">Data de início do contrato</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            type="date" id="dtiniNM"></td>
                                </tr>
                                <tr>
                                    <td class="col1">Contrato parcelado?</td>
                                    <td class="col2">
                                        <select class="w3-select w3-border-red" style="width:100px" id="FinNM">
                                            <option value="0">NÃO</option>
                                            <option value="1">SIM</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr colspan="1" align="center">
                                    <td class="col1">
                                        <button class="w3-button w3-red w3-ripple" onclick="calcularNM()"
                                            style="width:150px">Calcular</button>
                                    </td>
                                    <td class="col2">
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col1">Porcentagem de desconto</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="descNM" readonly></td>
                                </tr>
                                <tr>
                                    <td class="col1">Valor do total do desconto</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="VldescNM" readonly></td>
                                </tr>
                                <tr>
                                    <td class="col1">Valor do desconto por mês<br><i>(durante 3 meses)</i></td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="VldescmesNM"></td>
                                </tr>
                                <tr>
                                    <td class="col1">Valor do parcelamento</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="VlFinNM" readonly></td>
                                </tr>
                                <tr>
                                    <td class="col1">Valor a pagar</td>
                                    <td class="col2"><input class="w3-input w3-border-red" style="width:200px"
                                            id="VlPagNM" readonly></td>
                                </tr>
                            </table>
                        </td>
                        <td class="col2" style="width:50px"></td>
                        <td class="col3 w3-cell-top">
                            <table class="w3-card w3-light-grey" cellpadding="3" cellspacing="3" align="left">
                                <tr align="center">
                                    <td>
                                        ABRIR O.S. PARA:<br><b><i>CADASTRO > CADASTRO > APLICAÇÃO DE DESCONTO</b></i>
                                    </td>
                                </tr>
                                <tr class="w3-dark-grey" align="center" id="txtNM">
                                    <td>Favor aplicar o desconto de x,xx% na mensalidade durante 3 meses. Total de
                                        desconto: R$ xx,xx diluído em 3x de R$ xx,xx</td>
                                </tr>
                                <tr align="center">
                                    <td>
                                        <button class="w3-button w3-red w3-ripple" onclick="copyTextNM()">Clique aqui
                                            para copiar o texto</button>
                                    </td>
                                </tr>
                                <tr class="w3-pale-red" align="left">
                                    <td>
                                        <b>Regras:</b><br>
                                        • Não pode ter título vencido<br>
                                        • Não pode ter recebido desconto nos últimos 12 meses<br>
                                        • Deve ter mais de 6 meses de contrato
                                    </td>
                                </tr>
                            </table>
                        </td>
                </table>
            </h6>
        </div>

    </div>

    <script>

        function openCalc(evt, calcName) {
            var i, x, tablinks;
            x = document.getElementsByClassName("calc");
            for (i = 0; i < x.length; i++) {
                x[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablink");
            for (i = 0; i < x.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" w3-red", "");
            }
            document.getElementById(calcName).style.display = "block";
            evt.currentTarget.className += " w3-red";
        }

        function calcularPRI() {
            const dt30 = new Date("December 31, 2021");
            const dt40 = new Date("February 28, 2023");

            var dtini = new Date(document.getElementById('dtiniPRI').value);
            var dtvenc = new Date(document.getElementById('dtvencPRI').value);
            var ISS = parseFloat(document.getElementById('ISSPRI').value.replace(",", "."));
            var mens = parseFloat(document.getElementById('mensPRI').value.replace(/\./g, "").replace(",", "."));
            var IR = document.getElementById('IRPRI').value;
            var PCC = document.getElementById('PCCPRI').value;
            var Fin = document.getElementById('FinPRI').value;

            var qtdias = Math.ceil(Math.abs(dtvenc - dtini) / (1000 * 60 * 60 * 24));
            var VlISS = (ISS / 100) * (mens / 30 * qtdias);
            var VlIR = IR * 0.01 * (mens / 30 * qtdias);
            var VlPCC = PCC * 0.0465 * (mens / 30 * qtdias);
            var VlFin = 0;
            if (dtini <= dt30) {
                VlFin = Fin * 30;
            } else if (dtini <= dt40) {
                VlFin = Fin * 40;
            } else {
                VlFin = Fin * 50;
            }
            var VlPag = (mens / 30 * qtdias) - VlISS - VlIR - VlPCC + VlFin;

            document.getElementById('qtdiasPRI').value = qtdias;
            VlISS = VlISS.toFixed(2).replace(".", ",");
            document.getElementById('VlISSPRI').value = VlISS.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            VlIR = VlIR.toFixed(2).replace(".", ",");
            document.getElementById('VlIRPRI').value = VlIR.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            VlPCC = VlPCC.toFixed(2).replace(".", ",");
            document.getElementById('VlPCCPRI').value = VlPCC.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            VlFin = VlFin.toFixed(2).replace(".", ",");
            document.getElementById('VlFinPRI').value = VlFin.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            VlPag = VlPag.toFixed(2).replace(".", ",");
            document.getElementById('VlPagPRI').value = VlPag.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }

        function calcularPRC() {
            var dtcanc = new Date(document.getElementById('dtcancPRC').value);
            var dtvenc = new Date(document.getElementById('dtvencPRC').value);
            var ISS = parseFloat(document.getElementById('ISSPRC').value.replace(",", "."));
            var mens = parseFloat(document.getElementById('mensPRC').value.replace(/\./g, "").replace(",", "."));
            var IR = document.getElementById('IRPRC').value;
            var PCC = document.getElementById('PCCPRC').value;

            var dtfin = new Date(dtcanc.getTime() + 30 * (1000 * 60 * 60 * 24) + 3 * (1000 * 60 * 60));
            var dtaux = new Date(dtvenc.getTime() - 31 * (1000 * 60 * 60 * 24) + 3 * (1000 * 60 * 60));
            var dtv2 = new Date(dtvenc.getTime() + 3 * (1000 * 60 * 60));
            var qtdias = Math.ceil(Math.abs(dtfin - dtaux) / (1000 * 60 * 60 * 24));
            var VlISS = (ISS / 100) * (mens / 30 * qtdias);
            var VlIR = IR * 0.01 * (mens / 30 * qtdias);
            var VlPCC = PCC * 0.0465 * (mens / 30 * qtdias);
            var VlPag = (mens / 30 * qtdias) - VlISS - VlIR - VlPCC;

            document.getElementById('qtdiasPRC').value = qtdias;
            document.getElementById('dtfinPRC').value = dtfin.toLocaleString().split(',')[0];
            VlISS = VlISS.toFixed(2).replace(".", ",");
            document.getElementById('VlISSPRC').value = VlISS.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            VlIR = VlIR.toFixed(2).replace(".", ",");
            document.getElementById('VlIRPRC').value = VlIR.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            VlPCC = VlPCC.toFixed(2).replace(".", ",");
            document.getElementById('VlPCCPRC').value = VlPCC.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            if (qtdias > 30) {
                document.getElementById('VlPagPRC').value = "TÍTULO INTEGRAL";
                document.getElementById('txtPRC').innerHTML = "<td>Por favor, enviar dados para DI no valor do TÍTULO INTEGRAL referente ao pró-rata de cancelamento, que foi do dia " + dtfin.toLocaleString().split(',')[0] + " até " + dtv2.toLocaleString().split(',')[0] + " no e-mail:</td>";
            }
            else {
                VlPag = VlPag.toFixed(2).replace(".", ",");
                document.getElementById('VlPagPRC').value = VlPag.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                document.getElementById('txtPRC').innerHTML = "<td>Por favor, enviar dados para DI no valor de R$ " + VlPag.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".") + " referente ao pró-rata de cancelamento, que foi do dia " + dtfin.toLocaleString().split(',')[0] + " até " + dtv2.toLocaleString().split(',')[0] + " no e-mail:</td>";
            }
        }

        function calcularNM() {
            const dt30 = new Date("December 31, 2021");
            const dt40 = new Date("February 28, 2023");

            var dtini = new Date(document.getElementById('dtiniNM').value);
            var star = document.getElementById('starNM').value;
            var mens = parseFloat(document.getElementById('mensNM').value.replace(/\./g, "").replace(",", "."));
            var Fin = document.getElementById('FinNM').value;
            var porc;

            switch (star) {
                case "1":
                    document.getElementById('descNM').value = "0%";
                    porc = 0;
                    break;
                case "2":
                    document.getElementById('descNM').value = "10%";
                    porc = 0.1;
                    break;
                case "3":
                    document.getElementById('descNM').value = "15%";
                    porc = 0.15;
                    break;
                case "4":
                    document.getElementById('descNM').value = "20%";
                    porc = 0.2;
                    break;
                case "5":
                    document.getElementById('descNM').value = "20%";
                    porc = 0.2;
            }

            var VlFin = 0;
            if (dtini <= dt30) {
                VlFin = Fin * 30;
            } else if (dtini <= dt40) {
                VlFin = Fin * 40;
            } else {
                VlFin = Fin * 50;
            }

            var VldescmesNM = mens * porc;
            var VldescNM = 3 * VldescmesNM;
            var VlpagNM = mens - VldescmesNM + VlFin;

            VldescmesNM = VldescmesNM.toFixed(2).replace(".", ",");
            document.getElementById('VldescmesNM').value = VldescmesNM.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            VldescNM = VldescNM.toFixed(2).replace(".", ",");
            document.getElementById('VldescNM').value = VldescNM.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            VlFin = VlFin.toFixed(2).replace(".", ",");
            document.getElementById('VlFinNM').value = VlFin.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            VlpagNM = VlpagNM.toFixed(2).replace(".", ",");
            document.getElementById('VlPagNM').value = VlpagNM.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            document.getElementById('txtNM').innerHTML = "<td>Favor aplicar o desconto de " + document.getElementById('descNM').value + " na mensalidade durante 3 meses. Total de desconto: R$ " + document.getElementById('VldescNM').value + " diluído em 3x de R$ " + document.getElementById('VldescmesNM').value + "</td>";
        }

        function copyTextPRC() {
            var Text = document.getElementById('txtPRC').innerHTML;
            Text = Text.toString().replace("<td>", "");
            Text = Text.toString().replace("</td>", "");
            navigator.clipboard.writeText(Text);
            window.alert("Texto copiado");
        }

        function copyTextNM() {
            var Text = document.getElementById('txtNM').innerHTML;
            Text = Text.toString().replace("<td>", "");
            Text = Text.toString().replace("</td>", "");
            navigator.clipboard.writeText(Text);
            window.alert("Texto copiado");
        }

        function formatarValorCampo(campo) {
            var valor = campo.value.replace(/\D/g, "");
            valor = (valor / 100).toFixed(2).replace(".", ",");
            campo.value = valor.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }
    </script>
</body>

</html>